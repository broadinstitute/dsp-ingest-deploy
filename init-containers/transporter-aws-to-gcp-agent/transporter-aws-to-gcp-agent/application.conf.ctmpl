{{with $aws_secrets_path := env "AWS_SECRETS_PATH"}}{{with $s3_secret := vault $aws_secrets_path}}
org.broadinstitute.transporter {

    kafka {
        bootstrap-servers = ["{{env "BOOTSTRAP_SERVICE"}}.{{env "NAMESPACE"}}:9092"]
        application-id = "{{env "NAMESPACE"}}-transporter-agent"

        topics {
            request-topic = "{{env "REQUEST_TOPIC"}}"
            progress-topic = "{{env "PROGRESS_TOPIC"}}"
            result-topic = "{{env "RESULT_TOPIC"}}"
        }
    }

    runner-config {
        aws {
            access-key-id = "{{$s3_secret.Data.aws_access_key_id}}"
            secret-access-key = "{{$s3_secret.Data.aws_secret_access_key}}"
        }

        gcp {
            service-account-json = "/secrets/gcs/credentials.json"
        }
    }
}
{{end}}{{end}}
