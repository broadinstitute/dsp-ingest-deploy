{{with $env := env "ENVIRONMENT"}}
{{with $app := env "APPLICATION_NAME"}}
{{with $ingestProject := env "INGEST_PROJECT"}}
{{with $owner := env "OWNER"}}
{{with $secret := secret (printf "secret/dsde/monster/%s/%s/%s/cloudsql/logins/%s" $env $app $ingestProject $owner)}}
apiVersion: v1
kind: Secret
metadata:
  name: db
type: Opaque
data:
  dbname: {{$secret.Data.db_name | base64Encode}}
  username: {{$secret.Data.username | base64Encode}}
  password: {{$secret.Data.password | base64Encode}}
{{end}}{{end}}{{end}}{{end}}{{end}}